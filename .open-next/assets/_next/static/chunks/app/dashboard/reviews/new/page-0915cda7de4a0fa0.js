(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6562],{15:e=>{e.exports={uploader:"ImageUploader_uploader__yIjU_",label:"ImageUploader_label__X1xL7",dropzone:"ImageUploader_dropzone__U2xNH",fileInput:"ImageUploader_fileInput__GOFNg",dropzoneContent:"ImageUploader_dropzoneContent__mLxbL",uploadIcon:"ImageUploader_uploadIcon__g_mcp",hint:"ImageUploader_hint__nOIll",uploading:"ImageUploader_uploading__7bZq_",spinner:"ImageUploader_spinner__Eh6__",spin:"ImageUploader_spin__FGc6_",error:"ImageUploader_error__74yF_",imageGrid:"ImageUploader_imageGrid__XIMHr",imageItem:"ImageUploader_imageItem__APQDt",dragging:"ImageUploader_dragging__aPW2b",imageOverlay:"ImageUploader_imageOverlay__d5FdH",dragHandle:"ImageUploader_dragHandle__trQDp",removeBtn:"ImageUploader_removeBtn__CPom7",mainBadge:"ImageUploader_mainBadge__IdTx0"}},63:(e,a,r)=>{"use strict";var s=r(7260);r.o(s,"useParams")&&r.d(a,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(a,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(a,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(a,{useSearchParams:function(){return s.useSearchParams}})},143:(e,a,r)=>{"use strict";r.d(a,{o:()=>s.useLanguage});var s=r(3945)},2734:(e,a,r)=>{"use strict";r.d(a,{A:()=>_});var s=r(5155),t=r(2115),n=r(2694),l=r(15),i=r.n(l);function _(e){let{images:a,onChange:r,folder:l="blog",maxImages:_=10,single:o=!1,label:d="الصور"}=e,[c,p]=(0,t.useState)(!1),[g,m]=(0,t.useState)(""),[u,h]=(0,t.useState)(null),b=(0,t.useRef)(null),v=async e=>{if(!e||0===e.length)return;let s=o?1:_-a.length;if(s<=0)return void m("الحد الأقصى ".concat(_," صور"));p(!0),m("");let t=Array.from(e).slice(0,s),n=[];for(let e of t)try{let a=new FormData;a.append("file",e),a.append("folder",l);let r=await fetch("/api/upload",{method:"POST",body:a}),s=await r.json();if(!r.ok)throw Error(s.error||"فشل رفع الملف");n.push(s.url)}catch(e){m(e instanceof Error?e.message:"حدث خطأ أثناء الرفع")}n.length>0&&(o?r(n):r([...a,...n])),p(!1),b.current&&(b.current.value="")},f=async e=>{let s=a[e];try{await fetch("/api/upload?url=".concat(encodeURIComponent(s)),{method:"DELETE"})}catch(e){}r(a.filter((a,r)=>r!==e))},x=()=>{h(null)};return(0,s.jsxs)("div",{className:i().uploader,children:[(0,s.jsx)("label",{className:i().label,children:d}),(0,s.jsxs)("div",{className:i().dropzone,onClick:()=>{var e;return null==(e=b.current)?void 0:e.click()},onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),v(e.dataTransfer.files)},children:[(0,s.jsx)("input",{ref:b,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",multiple:!o,onChange:e=>v(e.target.files),className:i().fileInput}),c?(0,s.jsxs)("div",{className:i().uploading,children:[(0,s.jsx)("span",{className:i().spinner}),(0,s.jsx)("span",{children:"جاري الرفع..."})]}):(0,s.jsxs)("div",{className:i().dropzoneContent,children:[(0,s.jsx)(n.B88,{className:i().uploadIcon}),(0,s.jsx)("p",{children:"اسحب الصور هنا أو انقر للاختيار"}),(0,s.jsx)("span",{className:i().hint,children:"JPG, PNG, WebP, GIF - حد أقصى 5MB"})]})]}),g&&(0,s.jsx)("p",{className:i().error,children:g}),a.length>0&&(0,s.jsx)("div",{className:i().imageGrid,children:a.map((e,t)=>(0,s.jsxs)("div",{className:"".concat(i().imageItem," ").concat(u===t?i().dragging:""),draggable:!o,onDragStart:()=>{h(t)},onDragOver:e=>((e,s)=>{if(e.preventDefault(),null===u||u===s)return;let t=[...a],n=t[u];t.splice(u,1),t.splice(s,0,n),r(t),h(s)})(e,t),onDragEnd:x,children:[(0,s.jsx)("img",{src:e,alt:"صورة ".concat(t+1)}),(0,s.jsxs)("div",{className:i().imageOverlay,children:[!o&&(0,s.jsx)("span",{className:i().dragHandle,children:(0,s.jsx)(n.PfQ,{})}),(0,s.jsx)("button",{type:"button",className:i().removeBtn,onClick:()=>f(t),children:(0,s.jsx)(n.yGN,{})})]}),0===t&&!o&&(0,s.jsx)("span",{className:i().mainBadge,children:"رئيسية"})]},e))}),!o&&a.length>0&&(0,s.jsx)("p",{className:i().hint,children:"اسحب الصور لإعادة ترتيبها. الصورة الأولى هي الصورة الرئيسية."})]})}},5831:(e,a,r)=>{Promise.resolve().then(r.bind(r,6648))},6648:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>g});var s=r(5155),t=r(2115),n=r(63),l=r(2619),i=r.n(l),_=r(2694),o=r(2734),d=r(143),c=r(9513),p=r.n(c);function g(){let{t:e,isRTL:a}=(0,d.o)(),r=(0,n.useRouter)(),[l,c]=(0,t.useState)(!1),[g,m]=(0,t.useState)(""),[u,h]=(0,t.useState)([]),[b,v]=(0,t.useState)({customer_name:"",company_name:"",position:"",review_text:"",rating:5,status:"pending"}),f=e=>{let{name:a,value:r}=e.target;v(e=>({...e,[a]:"rating"===a?parseInt(r):r}))},x=async function(a){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(a.preventDefault(),!b.customer_name.trim()||!b.review_text.trim())return void m(e("dashboard.reviewRequired"));c(!0),m("");try{let a=await fetch("/api/admin/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...b,avatar_url:u[0]||null,status:s?"published":b.status})}),t=await a.json();if(!a.ok)throw Error(t.error||e("dashboard.errorOccurred"));r.push("/dashboard/reviews")}catch(a){m(a instanceof Error?a.message:e("dashboard.errorOccurred"))}finally{c(!1)}},j=a?_.dyV:_.kRp;return(0,s.jsx)("div",{className:p().dashboard,children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("div",{className:p().header,children:(0,s.jsxs)("div",{children:[(0,s.jsxs)(i(),{href:"/dashboard/reviews",className:p().backLink,children:[(0,s.jsx)(j,{}),e("dashboard.backToReviews")]}),(0,s.jsx)("h1",{children:e("dashboard.newReview")})]})}),(0,s.jsxs)("form",{onSubmit:x,className:p().formCard,children:[g&&(0,s.jsx)("div",{className:p().errorAlert,children:g}),(0,s.jsxs)("div",{className:p().formRow,children:[(0,s.jsxs)("div",{className:p().formGroup,children:[(0,s.jsxs)("label",{className:p().label,children:[e("dashboard.reviews.customerName")," *"]}),(0,s.jsx)("input",{type:"text",name:"customer_name",value:b.customer_name,onChange:f,className:p().input,placeholder:e("dashboard.reviews.customerNamePlaceholder"),required:!0})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[(0,s.jsx)("label",{className:p().label,children:e("dashboard.reviews.companyName")}),(0,s.jsx)("input",{type:"text",name:"company_name",value:b.company_name,onChange:f,className:p().input,placeholder:e("dashboard.reviews.companyNamePlaceholder")})]})]}),(0,s.jsxs)("div",{className:p().formRow,children:[(0,s.jsxs)("div",{className:p().formGroup,children:[(0,s.jsx)("label",{className:p().label,children:e("dashboard.reviews.position")}),(0,s.jsx)("input",{type:"text",name:"position",value:b.position,onChange:f,className:p().input,placeholder:e("dashboard.reviews.positionPlaceholder")})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[(0,s.jsx)("label",{className:p().label,children:e("dashboard.reviews.rating")}),(0,s.jsx)("div",{className:p().ratingInput,children:[1,2,3,4,5].map(e=>(0,s.jsx)("button",{type:"button",className:"".concat(p().starBtn," ").concat(b.rating>=e?p().active:""),onClick:()=>v(a=>({...a,rating:e})),children:(0,s.jsx)(_.usP,{})},e))})]})]}),(0,s.jsx)(o.A,{images:u,onChange:h,folder:"avatars",single:!0,label:e("dashboard.reviews.customerImage")}),(0,s.jsxs)("div",{className:p().formGroup,children:[(0,s.jsxs)("label",{className:p().label,children:[e("dashboard.reviews.reviewText")," *"]}),(0,s.jsx)("textarea",{name:"review_text",value:b.review_text,onChange:f,className:p().textarea,placeholder:e("dashboard.reviews.reviewTextPlaceholder"),rows:5,required:!0})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[(0,s.jsx)("label",{className:p().label,children:e("dashboard.reviews.status")}),(0,s.jsxs)("select",{name:"status",value:b.status,onChange:f,className:p().select,children:[(0,s.jsx)("option",{value:"pending",children:e("dashboard.reviews.statusPending")}),(0,s.jsx)("option",{value:"published",children:e("dashboard.reviews.statusPublished")})]})]}),(0,s.jsxs)("div",{className:p().formActions,children:[(0,s.jsxs)("button",{type:"submit",className:"btn btn-secondary",disabled:l,children:[(0,s.jsx)(_.Bc_,{}),e("common.save")]}),(0,s.jsxs)("button",{type:"button",className:"btn btn-primary",disabled:l,onClick:e=>x(e,!0),children:[(0,s.jsx)(_.Vap,{}),e("dashboard.publishNow")]})]})]})]})})}},9513:e=>{e.exports={dashboard:"page_dashboard__kNuGp",header:"page_header__hMSOF",statsGrid:"page_statsGrid___pqlK",statCard:"page_statCard__tKMY7",statIcon:"page_statIcon__jUdPR",primary:"page_primary__NNHI1",success:"page_success__DCYIY",warning:"page_warning__Pz2zu",info:"page_info__xXc7j",statInfo:"page_statInfo__hVtfu",statValue:"page_statValue__Ngvpx",statLabel:"page_statLabel__xyDJ2",mainGrid:"page_mainGrid__ORtMb",card:"page_card__FwMm5",cardHeader:"page_cardHeader__BKx4i",viewAll:"page_viewAll__xro1p",contentList:"page_contentList__LWyb1",contentItem:"page_contentItem__s3nz3",contentInfo:"page_contentInfo__GqgZj",company:"page_company__J1Du_",contentMeta:"page_contentMeta__hRWwu",badge:"page_badge__v8rDn",badgeSuccess:"page_badgeSuccess__ztJF8",badgeWarning:"page_badgeWarning___M_v2",date:"page_date__Y5SEs",rating:"page_rating__MjYmM",starFilled:"page_starFilled__XcnEJ",contentActions:"page_contentActions__o4MHh",actionBtn:"page_actionBtn__e1gK9",backLink:"page_backLink__10O1e",refreshBtn:"page_refreshBtn__C3waT",spinning:"page_spinning__st8Jr",spin:"page_spin__83Eln",loading:"page_loading__eqTbn",empty:"page_empty__7ZIVI",filters:"page_filters__BOlgE",filterBtn:"page_filterBtn__cEAgg",active:"page_active__sBdJ3",tableCard:"page_tableCard__sV85v",table:"page_table__t8tSi",titleCell:"page_titleCell__Zjy1Z",tableActions:"page_tableActions__qU_ki",danger:"page_danger__9lHzf",formCard:"page_formCard__N3yfk",formGroup:"page_formGroup__uGATh",formRow:"page_formRow__zaa3I",label:"page_label__iBEwE",input:"page_input__olAOO",select:"page_select__Ojb9E",textarea:"page_textarea__GBXO6",formActions:"page_formActions__w_nBD",errorAlert:"page_errorAlert__nHXMP",ratingInput:"page_ratingInput__RTdqJ",starBtn:"page_starBtn__brrSR",settingsGrid:"page_settingsGrid__OQYlm",settingsCard:"page_settingsCard__bTeJ5",settingsCardHeader:"page_settingsCardHeader__ycHQi",settingsIcon:"page_settingsIcon__Unn27",settingsForm:"page_settingsForm__Qyddf",settingsDesc:"page_settingsDesc__vE_u4",adminEmail:"page_adminEmail__4y_Xw",successAlert:"page_successAlert__AdipL",modal:"page_modal__uDDBs",modalContent:"page_modalContent__G_uO1",modalHeader:"page_modalHeader__jjc3E",closeBtn:"page_closeBtn__kFI75",tableWrapper:"page_tableWrapper__kYU93",logoPreview:"page_logoPreview__AI5jC",noLogo:"page_noLogo__V5uAu",typeLabel:"page_typeLabel__c2EaY",actionBtns:"page_actionBtns__nJt4M",quickLinks:"page_quickLinks__e8ky5",quickLinkCard:"page_quickLinkCard__RdZfR",quickLinkIcon:"page_quickLinkIcon__qA_f1",uploadArea:"page_uploadArea__y6Bt7",uploadPlaceholder:"page_uploadPlaceholder__MW9IE",uploadPreview:"page_uploadPreview__4V_e3",removePreview:"page_removePreview__XH8IV",fileInput:"page_fileInput__Vb3vt",spinner:"page_spinner__STN52"}}},e=>{e.O(0,[5071,6603,3193,3945,8441,1255,7358],()=>e(e.s=5831)),_N_E=e.O()}]);