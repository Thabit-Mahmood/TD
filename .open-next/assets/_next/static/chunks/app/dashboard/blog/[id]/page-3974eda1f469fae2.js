(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7156],{15:e=>{e.exports={uploader:"ImageUploader_uploader__yIjU_",label:"ImageUploader_label__X1xL7",dropzone:"ImageUploader_dropzone__U2xNH",fileInput:"ImageUploader_fileInput__GOFNg",dropzoneContent:"ImageUploader_dropzoneContent__mLxbL",uploadIcon:"ImageUploader_uploadIcon__g_mcp",hint:"ImageUploader_hint__nOIll",uploading:"ImageUploader_uploading__7bZq_",spinner:"ImageUploader_spinner__Eh6__",spin:"ImageUploader_spin__FGc6_",error:"ImageUploader_error__74yF_",imageGrid:"ImageUploader_imageGrid__XIMHr",imageItem:"ImageUploader_imageItem__APQDt",dragging:"ImageUploader_dragging__aPW2b",imageOverlay:"ImageUploader_imageOverlay__d5FdH",dragHandle:"ImageUploader_dragHandle__trQDp",removeBtn:"ImageUploader_removeBtn__CPom7",mainBadge:"ImageUploader_mainBadge__IdTx0"}},63:(e,a,t)=>{"use strict";var r=t(7260);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},143:(e,a,t)=>{"use strict";t.d(a,{o:()=>r.useLanguage});var r=t(3945)},593:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>g});var r=t(5155),s=t(2115),n=t(63),l=t(2619),o=t.n(l),i=t(2694),d=t(2734),_=t(143),c=t(9513),p=t.n(c);function g(){let{t:e,isRTL:a}=(0,_.o)(),t=(0,n.useParams)().id,l=(0,n.useRouter)(),[c,g]=(0,s.useState)(!0),[m,u]=(0,s.useState)(!1),[h,b]=(0,s.useState)(""),[f,x]=(0,s.useState)([]),[j,v]=(0,s.useState)({title:"",excerpt:"",content:"",status:"draft",meta_title:"",meta_description:""});(0,s.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/admin/blog/".concat(t));if(!a.ok)throw Error(e("dashboard.postNotFound"));let r=await a.json();v({title:r.title,excerpt:r.excerpt||"",content:r.content,status:r.status,meta_title:r.meta_title||"",meta_description:r.meta_description||""});let s=[];if(r.featured_image&&s.push(r.featured_image),r.images)try{let e=JSON.parse(r.images);s.push(...e)}catch(e){}x(s)}catch(a){b(a instanceof Error?a.message:e("dashboard.errorOccurred"))}finally{g(!1)}})()},[t,e]);let N=e=>{let{name:a,value:t}=e.target;v(e=>({...e,[a]:t}))},I=async function(a){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(a.preventDefault(),!j.title.trim()||!j.content.trim())return void b(e("dashboard.titleRequired"));u(!0),b("");try{let a=f[0]||null,s=f.slice(1),n=await fetch("/api/admin/blog/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...j,featured_image:a,images:s.length>0?JSON.stringify(s):null,status:r?"published":j.status})}),o=await n.json();if(!n.ok)throw Error(o.error||e("dashboard.errorOccurred"));l.push("/dashboard/blog")}catch(a){b(a instanceof Error?a.message:e("dashboard.errorOccurred"))}finally{u(!1)}},y=async()=>{if(confirm(e("dashboard.confirmDeletePost")))try{(await fetch("/api/admin/blog/".concat(t),{method:"DELETE"})).ok&&l.push("/dashboard/blog")}catch(a){b(e("dashboard.errorDeleting"))}},C=a?i.dyV:i.kRp;return c?(0,r.jsx)("div",{className:p().dashboard,children:(0,r.jsx)("div",{className:"container",children:(0,r.jsx)("div",{className:p().loading,children:e("dashboard.loading")})})}):(0,r.jsx)("div",{className:p().dashboard,children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsxs)("div",{className:p().header,children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(o(),{href:"/dashboard/blog",className:p().backLink,children:[(0,r.jsx)(C,{}),e("dashboard.backToBlog")]}),(0,r.jsx)("h1",{children:e("dashboard.editPost")})]}),(0,r.jsxs)("button",{onClick:y,className:"btn btn-danger",children:[(0,r.jsx)(i.IXo,{}),e("dashboard.delete")]})]}),(0,r.jsxs)("form",{onSubmit:I,className:p().formCard,children:[h&&(0,r.jsx)("div",{className:p().errorAlert,children:h}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsxs)("label",{className:p().label,children:[e("dashboard.blog.title")," *"]}),(0,r.jsx)("input",{type:"text",name:"title",value:j.title,onChange:N,className:p().input,placeholder:e("dashboard.blog.titlePlaceholder"),required:!0})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().label,children:e("dashboard.blog.excerpt")}),(0,r.jsx)("textarea",{name:"excerpt",value:j.excerpt,onChange:N,className:p().textarea,placeholder:e("dashboard.blog.excerptPlaceholderEdit"),rows:3})]}),(0,r.jsx)(d.A,{images:f,onChange:x,folder:"blog",maxImages:10,label:e("dashboard.blog.images")}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsxs)("label",{className:p().label,children:[e("dashboard.blog.content")," *"]}),(0,r.jsx)("textarea",{name:"content",value:j.content,onChange:N,className:p().textarea,placeholder:e("dashboard.blog.contentPlaceholder"),rows:15,required:!0})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().label,children:e("dashboard.blog.status")}),(0,r.jsxs)("select",{name:"status",value:j.status,onChange:N,className:p().select,children:[(0,r.jsx)("option",{value:"draft",children:e("dashboard.status.draft")}),(0,r.jsx)("option",{value:"published",children:e("dashboard.status.published")}),(0,r.jsx)("option",{value:"archived",children:e("dashboard.status.archived")})]})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().label,children:e("dashboard.blog.seoTitle")}),(0,r.jsx)("input",{type:"text",name:"meta_title",value:j.meta_title,onChange:N,className:p().input,placeholder:e("dashboard.blog.seoTitlePlaceholderEdit")})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().label,children:e("dashboard.blog.seoDescription")}),(0,r.jsx)("textarea",{name:"meta_description",value:j.meta_description,onChange:N,className:p().textarea,placeholder:e("dashboard.blog.seoDescriptionPlaceholderEdit"),rows:2})]}),(0,r.jsxs)("div",{className:p().formActions,children:[(0,r.jsxs)("button",{type:"submit",className:"btn btn-secondary",disabled:m,children:[(0,r.jsx)(i.Bc_,{}),e("dashboard.saveChanges")]}),"published"!==j.status&&(0,r.jsxs)("button",{type:"button",className:"btn btn-primary",disabled:m,onClick:e=>I(e,!0),children:[(0,r.jsx)(i.Vap,{}),e("dashboard.publishNow")]})]})]})]})})}},2734:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(5155),s=t(2115),n=t(2694),l=t(15),o=t.n(l);function i(e){let{images:a,onChange:t,folder:l="blog",maxImages:i=10,single:d=!1,label:_="الصور"}=e,[c,p]=(0,s.useState)(!1),[g,m]=(0,s.useState)(""),[u,h]=(0,s.useState)(null),b=(0,s.useRef)(null),f=async e=>{if(!e||0===e.length)return;let r=d?1:i-a.length;if(r<=0)return void m("الحد الأقصى ".concat(i," صور"));p(!0),m("");let s=Array.from(e).slice(0,r),n=[];for(let e of s)try{let a=new FormData;a.append("file",e),a.append("folder",l);let t=await fetch("/api/upload",{method:"POST",body:a}),r=await t.json();if(!t.ok)throw Error(r.error||"فشل رفع الملف");n.push(r.url)}catch(e){m(e instanceof Error?e.message:"حدث خطأ أثناء الرفع")}n.length>0&&(d?t(n):t([...a,...n])),p(!1),b.current&&(b.current.value="")},x=async e=>{let r=a[e];try{await fetch("/api/upload?url=".concat(encodeURIComponent(r)),{method:"DELETE"})}catch(e){}t(a.filter((a,t)=>t!==e))},j=()=>{h(null)};return(0,r.jsxs)("div",{className:o().uploader,children:[(0,r.jsx)("label",{className:o().label,children:_}),(0,r.jsxs)("div",{className:o().dropzone,onClick:()=>{var e;return null==(e=b.current)?void 0:e.click()},onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),f(e.dataTransfer.files)},children:[(0,r.jsx)("input",{ref:b,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",multiple:!d,onChange:e=>f(e.target.files),className:o().fileInput}),c?(0,r.jsxs)("div",{className:o().uploading,children:[(0,r.jsx)("span",{className:o().spinner}),(0,r.jsx)("span",{children:"جاري الرفع..."})]}):(0,r.jsxs)("div",{className:o().dropzoneContent,children:[(0,r.jsx)(n.B88,{className:o().uploadIcon}),(0,r.jsx)("p",{children:"اسحب الصور هنا أو انقر للاختيار"}),(0,r.jsx)("span",{className:o().hint,children:"JPG, PNG, WebP, GIF - حد أقصى 5MB"})]})]}),g&&(0,r.jsx)("p",{className:o().error,children:g}),a.length>0&&(0,r.jsx)("div",{className:o().imageGrid,children:a.map((e,s)=>(0,r.jsxs)("div",{className:"".concat(o().imageItem," ").concat(u===s?o().dragging:""),draggable:!d,onDragStart:()=>{h(s)},onDragOver:e=>((e,r)=>{if(e.preventDefault(),null===u||u===r)return;let s=[...a],n=s[u];s.splice(u,1),s.splice(r,0,n),t(s),h(r)})(e,s),onDragEnd:j,children:[(0,r.jsx)("img",{src:e,alt:"صورة ".concat(s+1)}),(0,r.jsxs)("div",{className:o().imageOverlay,children:[!d&&(0,r.jsx)("span",{className:o().dragHandle,children:(0,r.jsx)(n.PfQ,{})}),(0,r.jsx)("button",{type:"button",className:o().removeBtn,onClick:()=>x(s),children:(0,r.jsx)(n.yGN,{})})]}),0===s&&!d&&(0,r.jsx)("span",{className:o().mainBadge,children:"رئيسية"})]},e))}),!d&&a.length>0&&(0,r.jsx)("p",{className:o().hint,children:"اسحب الصور لإعادة ترتيبها. الصورة الأولى هي الصورة الرئيسية."})]})}},7663:(e,a,t)=>{Promise.resolve().then(t.bind(t,593))},9513:e=>{e.exports={dashboard:"page_dashboard__kNuGp",header:"page_header__hMSOF",statsGrid:"page_statsGrid___pqlK",statCard:"page_statCard__tKMY7",statIcon:"page_statIcon__jUdPR",primary:"page_primary__NNHI1",success:"page_success__DCYIY",warning:"page_warning__Pz2zu",info:"page_info__xXc7j",statInfo:"page_statInfo__hVtfu",statValue:"page_statValue__Ngvpx",statLabel:"page_statLabel__xyDJ2",mainGrid:"page_mainGrid__ORtMb",card:"page_card__FwMm5",cardHeader:"page_cardHeader__BKx4i",viewAll:"page_viewAll__xro1p",contentList:"page_contentList__LWyb1",contentItem:"page_contentItem__s3nz3",contentInfo:"page_contentInfo__GqgZj",company:"page_company__J1Du_",contentMeta:"page_contentMeta__hRWwu",badge:"page_badge__v8rDn",badgeSuccess:"page_badgeSuccess__ztJF8",badgeWarning:"page_badgeWarning___M_v2",date:"page_date__Y5SEs",rating:"page_rating__MjYmM",starFilled:"page_starFilled__XcnEJ",contentActions:"page_contentActions__o4MHh",actionBtn:"page_actionBtn__e1gK9",backLink:"page_backLink__10O1e",refreshBtn:"page_refreshBtn__C3waT",spinning:"page_spinning__st8Jr",spin:"page_spin__83Eln",loading:"page_loading__eqTbn",empty:"page_empty__7ZIVI",filters:"page_filters__BOlgE",filterBtn:"page_filterBtn__cEAgg",active:"page_active__sBdJ3",tableCard:"page_tableCard__sV85v",table:"page_table__t8tSi",titleCell:"page_titleCell__Zjy1Z",tableActions:"page_tableActions__qU_ki",danger:"page_danger__9lHzf",formCard:"page_formCard__N3yfk",formGroup:"page_formGroup__uGATh",formRow:"page_formRow__zaa3I",label:"page_label__iBEwE",input:"page_input__olAOO",select:"page_select__Ojb9E",textarea:"page_textarea__GBXO6",formActions:"page_formActions__w_nBD",errorAlert:"page_errorAlert__nHXMP",ratingInput:"page_ratingInput__RTdqJ",starBtn:"page_starBtn__brrSR",settingsGrid:"page_settingsGrid__OQYlm",settingsCard:"page_settingsCard__bTeJ5",settingsCardHeader:"page_settingsCardHeader__ycHQi",settingsIcon:"page_settingsIcon__Unn27",settingsForm:"page_settingsForm__Qyddf",settingsDesc:"page_settingsDesc__vE_u4",adminEmail:"page_adminEmail__4y_Xw",successAlert:"page_successAlert__AdipL",modal:"page_modal__uDDBs",modalContent:"page_modalContent__G_uO1",modalHeader:"page_modalHeader__jjc3E",closeBtn:"page_closeBtn__kFI75",tableWrapper:"page_tableWrapper__kYU93",logoPreview:"page_logoPreview__AI5jC",noLogo:"page_noLogo__V5uAu",typeLabel:"page_typeLabel__c2EaY",actionBtns:"page_actionBtns__nJt4M",quickLinks:"page_quickLinks__e8ky5",quickLinkCard:"page_quickLinkCard__RdZfR",quickLinkIcon:"page_quickLinkIcon__qA_f1",uploadArea:"page_uploadArea__y6Bt7",uploadPlaceholder:"page_uploadPlaceholder__MW9IE",uploadPreview:"page_uploadPreview__4V_e3",removePreview:"page_removePreview__XH8IV",fileInput:"page_fileInput__Vb3vt",spinner:"page_spinner__STN52"}}},e=>{e.O(0,[5071,6603,3193,3945,8441,1255,7358],()=>e(e.s=7663)),_N_E=e.O()}]);