(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7814],{1647:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>p});var s=t(5155),n=t(2115),l=t(2619),i=t.n(l),r=t(5239),c=t(2694),_=t(3945),d=t(9513),o=t.n(d);function p(){let{t:e,language:a}=(0,_.useLanguage)(),[t,l]=(0,n.useState)([]),[d,p]=(0,n.useState)(!0),[g,h]=(0,n.useState)(!1),[u,m]=(0,n.useState)(null),[b,j]=(0,n.useState)({name:"",logo_url:""}),[f,x]=(0,n.useState)(""),[v,N]=(0,n.useState)(!1),[y,w]=(0,n.useState)(null),k=(0,n.useRef)(null),C="ar"===a?c.dyV:c.kRp,I=async()=>{p(!0);try{let e=await fetch("/api/clients?all=true&t=".concat(Date.now()),{cache:"no-store"}),a=await e.json();l(a.clients||[])}catch(e){}finally{p(!1)}};(0,n.useEffect)(()=>{I()},[]);let B=async e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];if(!t)return;let s=new FileReader;s.onload=e=>{var a;w(null==(a=e.target)?void 0:a.result)},s.readAsDataURL(t),N(!0),x("");try{let e=new FormData;e.append("file",t),e.append("folder","clients");let a=await fetch("/api/upload",{method:"POST",body:e}),s=await a.json();if(!a.ok)throw Error(s.error||"Upload failed");j({...b,logo_url:s.url})}catch(e){x(e instanceof Error?e.message:"Upload failed"),w(null)}finally{N(!1)}},A=async a=>{if(a.preventDefault(),x(""),v)return void x("Please wait for the image to finish uploading");if(!b.name.trim())return void x(e("dashboard.clients.nameRequired"));p(!0);try{let e=u?"PUT":"POST",a=u?{id:u.id,...b,is_active:u.is_active}:b,t=await fetch("/api/clients",{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to save");h(!1),m(null),j({name:"",logo_url:""}),w(null),await I()}catch(a){x(a instanceof Error?a.message:e("dashboard.errorOccurred"))}finally{p(!1)}},E=async a=>{if(confirm(e("dashboard.clients.confirmDelete")))try{await fetch("/api/clients?id=".concat(a),{method:"DELETE"}),I()}catch(e){}},L=async e=>{try{await fetch("/api/clients",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,is_active:+!e.is_active})}),I()}catch(e){}},P=()=>{h(!1),m(null),j({name:"",logo_url:""}),w(null),x("")};return(0,s.jsx)("div",{className:o().dashboard,children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:o().header,children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(i(),{href:"/dashboard",className:o().backLink,children:[(0,s.jsx)(C,{}),e("dashboard.backToDashboard")]}),(0,s.jsx)("h1",{children:e("dashboard.clients.title")})]}),(0,s.jsxs)("button",{className:"btn btn-primary",onClick:()=>{h(!0),m(null),j({name:"",logo_url:""}),w(null),x("")},children:[(0,s.jsx)(c.GGD,{}),e("dashboard.clients.addNew")]})]}),g&&(0,s.jsx)("div",{className:o().modal,children:(0,s.jsxs)("div",{className:o().modalContent,children:[(0,s.jsxs)("div",{className:o().modalHeader,children:[(0,s.jsx)("h2",{children:u?e("dashboard.clients.edit"):e("dashboard.clients.addNew")}),(0,s.jsx)("button",{onClick:P,className:o().closeBtn,children:(0,s.jsx)(c.yGN,{})})]}),(0,s.jsxs)("form",{onSubmit:A,className:o().settingsForm,children:[f&&(0,s.jsx)("div",{className:o().errorAlert,children:f}),(0,s.jsxs)("div",{className:o().formGroup,children:[(0,s.jsx)("label",{className:o().label,children:e("dashboard.clients.name")}),(0,s.jsx)("input",{type:"text",value:b.name,onChange:e=>j({...b,name:e.target.value}),className:o().input,placeholder:e("dashboard.clients.namePlaceholder")})]}),(0,s.jsxs)("div",{className:o().formGroup,children:[(0,s.jsx)("label",{className:o().label,children:e("dashboard.clients.logo")}),(0,s.jsxs)("div",{className:o().uploadArea,children:[y?(0,s.jsxs)("div",{className:o().uploadPreview,children:[(0,s.jsx)(r.default,{src:y,alt:"Preview",width:120,height:60,style:{objectFit:"contain"}}),(0,s.jsx)("button",{type:"button",className:o().removePreview,onClick:()=>{w(null),j({...b,logo_url:""}),k.current&&(k.current.value="")},children:(0,s.jsx)(c.yGN,{})})]}):(0,s.jsx)("div",{className:o().uploadPlaceholder,onClick:()=>{var e;return null==(e=k.current)?void 0:e.click()},children:v?(0,s.jsx)("span",{className:o().spinner}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.B88,{size:24}),(0,s.jsx)("span",{children:e("dashboard.clients.uploadLogo")})]})}),(0,s.jsx)("input",{ref:k,type:"file",accept:"image/*",onChange:B,className:o().fileInput,disabled:v})]})]}),(0,s.jsxs)("div",{className:o().formActions,children:[(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:v||d,children:d?(0,s.jsx)("span",{className:o().spinner}):u?e("dashboard.saveChanges"):e("dashboard.clients.add")}),(0,s.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:P,disabled:d,children:e("common.cancel")})]})]})]})}),(0,s.jsx)("div",{className:o().card,children:d?(0,s.jsx)("div",{className:o().loading,children:e("dashboard.loading")}):0===t.length?(0,s.jsx)("div",{className:o().empty,children:e("dashboard.clients.noClients")}):(0,s.jsx)("div",{className:o().tableWrapper,children:(0,s.jsxs)("table",{className:o().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:e("dashboard.clients.logo")}),(0,s.jsx)("th",{children:e("dashboard.clients.name")}),(0,s.jsx)("th",{children:e("dashboard.clients.status")}),(0,s.jsx)("th",{children:e("dashboard.clients.actions")})]})}),(0,s.jsx)("tbody",{children:t.map(a=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:a.logo_url?(0,s.jsx)(r.default,{src:a.logo_url,alt:a.name,width:60,height:30,className:o().logoPreview,style:{objectFit:"contain"}}):(0,s.jsx)("div",{className:o().noLogo,children:(0,s.jsx)(c.fZZ,{})})}),(0,s.jsx)("td",{children:a.name}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"".concat(o().badge," ").concat(a.is_active?o().badgeSuccess:o().badgeWarning),children:a.is_active?e("dashboard.clients.active"):e("dashboard.clients.inactive")})}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:o().actionBtns,children:[(0,s.jsx)("button",{onClick:()=>L(a),className:o().actionBtn,title:a.is_active?e("dashboard.clients.deactivate"):e("dashboard.clients.activate"),children:a.is_active?(0,s.jsx)(c.yGN,{}):(0,s.jsx)(c.YrT,{})}),(0,s.jsx)("button",{onClick:()=>{m(a),j({name:a.name,logo_url:a.logo_url||""}),w(a.logo_url),h(!0)},className:o().actionBtn,children:(0,s.jsx)(c.WXf,{})}),(0,s.jsx)("button",{onClick:()=>E(a.id),className:"".concat(o().actionBtn," ").concat(o().danger),children:(0,s.jsx)(c.IXo,{})})]})})]},a.id))})]})})})]})})}},9513:e=>{e.exports={dashboard:"page_dashboard__kNuGp",header:"page_header__hMSOF",statsGrid:"page_statsGrid___pqlK",statCard:"page_statCard__tKMY7",statIcon:"page_statIcon__jUdPR",primary:"page_primary__NNHI1",success:"page_success__DCYIY",warning:"page_warning__Pz2zu",info:"page_info__xXc7j",statInfo:"page_statInfo__hVtfu",statValue:"page_statValue__Ngvpx",statLabel:"page_statLabel__xyDJ2",mainGrid:"page_mainGrid__ORtMb",card:"page_card__FwMm5",cardHeader:"page_cardHeader__BKx4i",viewAll:"page_viewAll__xro1p",contentList:"page_contentList__LWyb1",contentItem:"page_contentItem__s3nz3",contentInfo:"page_contentInfo__GqgZj",company:"page_company__J1Du_",contentMeta:"page_contentMeta__hRWwu",badge:"page_badge__v8rDn",badgeSuccess:"page_badgeSuccess__ztJF8",badgeWarning:"page_badgeWarning___M_v2",date:"page_date__Y5SEs",rating:"page_rating__MjYmM",starFilled:"page_starFilled__XcnEJ",contentActions:"page_contentActions__o4MHh",actionBtn:"page_actionBtn__e1gK9",backLink:"page_backLink__10O1e",refreshBtn:"page_refreshBtn__C3waT",spinning:"page_spinning__st8Jr",spin:"page_spin__83Eln",loading:"page_loading__eqTbn",empty:"page_empty__7ZIVI",filters:"page_filters__BOlgE",filterBtn:"page_filterBtn__cEAgg",active:"page_active__sBdJ3",tableCard:"page_tableCard__sV85v",table:"page_table__t8tSi",titleCell:"page_titleCell__Zjy1Z",tableActions:"page_tableActions__qU_ki",danger:"page_danger__9lHzf",formCard:"page_formCard__N3yfk",formGroup:"page_formGroup__uGATh",formRow:"page_formRow__zaa3I",label:"page_label__iBEwE",input:"page_input__olAOO",select:"page_select__Ojb9E",textarea:"page_textarea__GBXO6",formActions:"page_formActions__w_nBD",errorAlert:"page_errorAlert__nHXMP",ratingInput:"page_ratingInput__RTdqJ",starBtn:"page_starBtn__brrSR",settingsGrid:"page_settingsGrid__OQYlm",settingsCard:"page_settingsCard__bTeJ5",settingsCardHeader:"page_settingsCardHeader__ycHQi",settingsIcon:"page_settingsIcon__Unn27",settingsForm:"page_settingsForm__Qyddf",settingsDesc:"page_settingsDesc__vE_u4",adminEmail:"page_adminEmail__4y_Xw",successAlert:"page_successAlert__AdipL",modal:"page_modal__uDDBs",modalContent:"page_modalContent__G_uO1",modalHeader:"page_modalHeader__jjc3E",closeBtn:"page_closeBtn__kFI75",tableWrapper:"page_tableWrapper__kYU93",logoPreview:"page_logoPreview__AI5jC",noLogo:"page_noLogo__V5uAu",typeLabel:"page_typeLabel__c2EaY",actionBtns:"page_actionBtns__nJt4M",quickLinks:"page_quickLinks__e8ky5",quickLinkCard:"page_quickLinkCard__RdZfR",quickLinkIcon:"page_quickLinkIcon__qA_f1",uploadArea:"page_uploadArea__y6Bt7",uploadPlaceholder:"page_uploadPlaceholder__MW9IE",uploadPreview:"page_uploadPreview__4V_e3",removePreview:"page_removePreview__XH8IV",fileInput:"page_fileInput__Vb3vt",spinner:"page_spinner__STN52"}},9654:(e,a,t)=>{Promise.resolve().then(t.bind(t,1647))}},e=>{e.O(0,[5071,6603,3193,5239,3945,8441,1255,7358],()=>e(e.s=9654)),_N_E=e.O()}]);